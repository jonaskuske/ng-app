(window.webpackJsonp=window.webpackJsonp||[]).push([[3],{"lCZ+":function(t,e,o){"use strict";o.r(e),o.d(e,"HmrBeforeDestroyAction",(function(){return h})),o.d(e,"HmrInitAction",(function(){return c})),o.d(e,"hmr",(function(){return f})),o.d(e,"hmrIsReloaded",(function(){return m}));var s=o("mrSG"),r=o("fXoL"),n=o("z5Zb"),i=o("AcyG"),a=o("tkUl");class c{constructor(t){this.payload=t}static get type(){return"@@HMR_INIT"}}class h{constructor(t){this.payload=t}static get type(){return"@@HMR_BEFORE_DESTROY"}}class l{constructor(t){const e=t.injector.get(i.k,void 0);if(!e)throw new Error("Store not found, maybe you forgot to import the NgxsModule");this.store=e}createStateContext(){return{dispatch:t=>this.store.dispatch(t),getState:()=>this.store.snapshot(),setState:t=>(Object(a.a)(t)&&(t=t(this.store.snapshot())),this.store.reset(t),t),patchState:t=>{const e=this.store.snapshot(),o=Object.assign({},e,t);return this.store.reset(o),o}}}}class u{constructor({deferTime:t,autoClearLogs:e}){this.deferTime=t||100,this.autoClearLogs=void 0===e||e}clearLogs(){this.autoClearLogs&&console.clear()}}class d{constructor(t,e,o,s,r){this.ngAppModule=t,this.bootstrap=e,this.storage=o,this.context=s,this.options=r}hmrNgxsStoreOnInit(t){let e=this.getModuleHmrInitCallback();e=e.bind(this.ngAppModule),this.stateEventLoop((o,s)=>{e(o,s),t(o,s)})}getModuleHmrInitCallback(){return"function"==typeof this.ngAppModule.hmrNgxsStoreOnInit?this.ngAppModule.hmrNgxsStoreOnInit:function(t,e){t.patchState(e)}}hmrNgxsStoreBeforeOnDestroy(){let t={};const e=this.context.createStateContext();return t="function"==typeof this.ngAppModule.hmrNgxsStoreBeforeOnDestroy?this.ngAppModule.hmrNgxsStoreBeforeOnDestroy(e):e.getState(),e.dispatch(new h(t)),t}stateEventLoop(t){if(!this.storage.hasData())return;const e=this.bootstrap.appBootstrapped$,o=this.context.store.select(t=>t);e.subscribe(()=>{let e;const s=o.subscribe(()=>{clearInterval(e),e=window.setTimeout(()=>{s.unsubscribe(),t(this.context.createStateContext(),this.storage.snapshot)},this.options.deferTime)})})}}class p{constructor(t,e){this.storage=e,this.optionsBuilder=new u(t)}get applicationRef(){return this.ngModule.injector.get(r.g)}get bootstrap(){return this.ngModule.injector.get(n.e)}hmrModule(t,e){return Object(s.a)(this,void 0,void 0,(function*(){return n.b.set(this.storage.snapshot),this.ngModule=yield t(),this.context=new l(this.ngModule),this.lifecycle=this.createLifecycle(),e(),n.b.pop(),this.ngModule}))}beforeModuleBootstrap(){this.lifecycle.hmrNgxsStoreOnInit((t,e)=>{t.dispatch(new c(e))})}beforeModuleOnDestroy(){return this.optionsBuilder.clearLogs(),this.lifecycle.hmrNgxsStoreBeforeOnDestroy()}createNewModule(){const t=this.cloneHostsBeforeDestroy();this.removeNgStyles(),this.ngModule.destroy(),t()}createLifecycle(){return new d(this.ngModule.instance,this.bootstrap,this.storage,this.context,this.optionsBuilder)}cloneHostsBeforeDestroy(){const t=this.applicationRef.components.map(t=>t.location.nativeElement).map(t=>{const e=document.createElement(t.tagName),o=t.parentNode,s=e.style.display;return e.style.display="none",o.insertBefore(e,t),()=>{e.style.display=s;try{o.removeChild(t)}catch(r){}}});return function(){t.forEach(t=>t())}}removeNgStyles(){const t=document.head;Array.from(t.querySelectorAll("style")).filter(t=>t.innerText.includes("_ng")).map(e=>t.removeChild(e))}}class g{constructor(t={}){this._snapshot=t}hasData(){return Object.keys(this._snapshot).length>0}get snapshot(){return this._snapshot}}function f(t,e,o={}){return Object(s.a)(this,void 0,void 0,(function*(){if(!t.hot)throw console.error("Are you using the --hmr flag for ng serve?"),new Error("HMR is not enabled for webpack-dev-server!");window.NGXS_HMR_LIFECYCLE_STATUS=window.NGXS_HMR_LIFECYCLE_STATUS||{hmrReloaded:!1},t.hot.accept();const s=new g((t.hot.data||{}).snapshot||{}),r=new p(o,s);return yield r.hmrModule(e,()=>{r.beforeModuleBootstrap(),t.hot.dispose(t=>{!function(t){window.NGXS_HMR_LIFECYCLE_STATUS&&(window.NGXS_HMR_LIFECYCLE_STATUS.hmrReloaded=!0)}(),t.snapshot=r.beforeModuleOnDestroy(),r.createNewModule()})})}))}function m(){return!(!window.NGXS_HMR_LIFECYCLE_STATUS||!window.NGXS_HMR_LIFECYCLE_STATUS.hmrReloaded)}}}]);
//# sourceMappingURL=ngxs-hmr-plugin-es2015.93e98974faf45ef720f3.js.map