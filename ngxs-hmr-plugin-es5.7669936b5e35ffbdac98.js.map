{"version":3,"sources":["webpack:///node_modules/@ngxs/hmr-plugin/fesm2015/ngxs-hmr-plugin.js"],"names":["HmrInitAction","payload","this","HmrBeforeDestroyAction","HmrStateContextFactory","module","store","injector","get","Error","dispatch","actions","getState","snapshot","setState","val","reset","patchState","currentState","newState","Object","assign","HmrOptionBuilder","autoClearLogs","deferTime","console","clear","HmrLifecycle","ngAppModule","bootstrap","storage","context","options","hmrAfterOnInit","moduleHmrInit","getModuleHmrInitCallback","bind","stateEventLoop","ctx","state","hmrNgxsStoreOnInit","createStateContext","hmrNgxsStoreBeforeOnDestroy","callback","hasData","appBootstrapped$","state$","select","subscribe","eventId","storeEventId","clearInterval","window","setTimeout","unsubscribe","HmrManager","optionsBuilder","bootstrapFn","tick","ngModule","set","lifecycle","createLifecycle","pop","clearLogs","removeOldHosts","cloneHostsBeforeDestroy","removeNgStyles","destroy","instance","removableList","applicationRef","components","map","component","location","nativeElement","componentNode","newNode","document","createElement","tagName","parentNode","currentDisplay","style","display","insertBefore","removeChild","_a","forEach","removeOldHost","head","Array","from","querySelectorAll","filter","innerText","includes","HmrStorage","_snapshot","keys","length","hmr","webpackModule","hot","error","hmrReloaded","accept","data","manager","hmrModule","beforeModuleBootstrap","dispose","beforeModuleOnDestroy","createNewModule","hmrIsReloaded"],"mappings":"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","file":"x","sourcesContent":["import { __awaiter } from 'tslib';\nimport { ApplicationRef } from '@angular/core';\nimport { NgxsBootstrapper, InitialState } from '@ngxs/store/internals';\nimport { Store } from '@ngxs/store';\nimport { isStateOperator } from '@ngxs/store/operators';\n\n/**\r\n * @fileoverview added by tsickle\r\n * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc\r\n */\r\nclass HmrInitAction {\r\n    /**\r\n     * @param {?} payload\r\n     */\r\n    constructor(payload) {\r\n        this.payload = payload;\r\n    }\r\n    /**\r\n     * @return {?}\r\n     */\r\n    static get type() {\r\n        // NOTE: Not necessary to declare the type in this way in your code. See https://github.com/ngxs/store/pull/644#issuecomment-436003138\r\n        return '@@HMR_INIT';\r\n    }\r\n}\r\nif (false) {\r\n    /** @type {?} */\r\n    HmrInitAction.prototype.payload;\r\n}\n\n/**\r\n * @fileoverview added by tsickle\r\n * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc\r\n */\r\nclass HmrBeforeDestroyAction {\r\n    /**\r\n     * @param {?} payload\r\n     */\r\n    constructor(payload) {\r\n        this.payload = payload;\r\n    }\r\n    /**\r\n     * @return {?}\r\n     */\r\n    static get type() {\r\n        // NOTE: Not necessary to declare the type in this way in your code. See https://github.com/ngxs/store/pull/644#issuecomment-436003138\r\n        return '@@HMR_BEFORE_DESTROY';\r\n    }\r\n}\r\nif (false) {\r\n    /** @type {?} */\r\n    HmrBeforeDestroyAction.prototype.payload;\r\n}\n\n/**\r\n * @fileoverview added by tsickle\r\n * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc\r\n */\r\n/**\r\n * @template T, S\r\n */\r\nclass HmrStateContextFactory {\r\n    /**\r\n     * @param {?} module\r\n     */\r\n    constructor(module) {\r\n        /** @type {?} */\r\n        const store = module.injector.get(Store, undefined);\r\n        if (!store) {\r\n            throw new Error('Store not found, maybe you forgot to import the NgxsModule');\r\n        }\r\n        this.store = store;\r\n    }\r\n    /**\r\n     * \\@description\r\n     * must be taken out into  \\@ngxs/store/internals\r\n     * @return {?}\r\n     */\r\n    createStateContext() {\r\n        return {\r\n            dispatch: (/**\r\n             * @param {?} actions\r\n             * @return {?}\r\n             */\r\n            actions => (/** @type {?} */ (this.store)).dispatch(actions)),\r\n            getState: (/**\r\n             * @return {?}\r\n             */\r\n            () => (/** @type {?} */ ((/** @type {?} */ (this.store)).snapshot()))),\r\n            setState: (/**\r\n             * @param {?} val\r\n             * @return {?}\r\n             */\r\n            val => {\r\n                if (isStateOperator(val)) {\r\n                    /** @type {?} */\r\n                    const currentState = (/** @type {?} */ (this.store)).snapshot();\r\n                    val = val(currentState);\r\n                }\r\n                (/** @type {?} */ (this.store)).reset(val);\r\n                return (/** @type {?} */ (val));\r\n            }),\r\n            patchState: (/**\r\n             * @param {?} val\r\n             * @return {?}\r\n             */\r\n            val => {\r\n                /** @type {?} */\r\n                const currentState = (/** @type {?} */ (this.store)).snapshot();\r\n                /** @type {?} */\r\n                const newState = Object.assign({}, currentState, ((/** @type {?} */ (val))));\r\n                (/** @type {?} */ (this.store)).reset(newState);\r\n                return newState;\r\n            })\r\n        };\r\n    }\r\n}\r\nif (false) {\r\n    /** @type {?} */\r\n    HmrStateContextFactory.prototype.store;\r\n}\n\n/**\r\n * @fileoverview added by tsickle\r\n * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc\r\n */\r\nclass HmrOptionBuilder {\r\n    /**\r\n     * @param {?} __0\r\n     */\r\n    constructor({ deferTime, autoClearLogs }) {\r\n        this.deferTime = deferTime || 100;\r\n        this.autoClearLogs = autoClearLogs === undefined ? true : autoClearLogs;\r\n    }\r\n    /**\r\n     * @return {?}\r\n     */\r\n    clearLogs() {\r\n        if (this.autoClearLogs) {\r\n            console.clear();\r\n        }\r\n    }\r\n}\r\nif (false) {\r\n    /** @type {?} */\r\n    HmrOptionBuilder.prototype.deferTime;\r\n    /** @type {?} */\r\n    HmrOptionBuilder.prototype.autoClearLogs;\r\n}\n\n/**\r\n * @fileoverview added by tsickle\r\n * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc\r\n */\r\n/**\r\n * @template T, S\r\n */\r\nclass HmrLifecycle {\r\n    /**\r\n     * @param {?} ngAppModule\r\n     * @param {?} bootstrap\r\n     * @param {?} storage\r\n     * @param {?} context\r\n     * @param {?} options\r\n     */\r\n    constructor(ngAppModule, bootstrap, storage, context, options) {\r\n        this.ngAppModule = ngAppModule;\r\n        this.bootstrap = bootstrap;\r\n        this.storage = storage;\r\n        this.context = context;\r\n        this.options = options;\r\n    }\r\n    /**\r\n     * @param {?} hmrAfterOnInit\r\n     * @return {?}\r\n     */\r\n    hmrNgxsStoreOnInit(hmrAfterOnInit) {\r\n        /** @type {?} */\r\n        let moduleHmrInit = this.getModuleHmrInitCallback();\r\n        moduleHmrInit = moduleHmrInit.bind(this.ngAppModule);\r\n        this.stateEventLoop((/**\r\n         * @param {?} ctx\r\n         * @param {?} state\r\n         * @return {?}\r\n         */\r\n        (ctx, state) => {\r\n            moduleHmrInit(ctx, state);\r\n            hmrAfterOnInit(ctx, state);\r\n        }));\r\n    }\r\n    /**\r\n     * @private\r\n     * @return {?}\r\n     */\r\n    getModuleHmrInitCallback() {\r\n        if (typeof this.ngAppModule.hmrNgxsStoreOnInit === 'function') {\r\n            return this.ngAppModule.hmrNgxsStoreOnInit;\r\n        }\r\n        return (/**\r\n         * @param {?} ctx\r\n         * @param {?} state\r\n         * @return {?}\r\n         */\r\n        function defaultModuleHmrInit(ctx, state) {\r\n            ctx.patchState(state);\r\n        });\r\n    }\r\n    /**\r\n     * @return {?}\r\n     */\r\n    hmrNgxsStoreBeforeOnDestroy() {\r\n        /** @type {?} */\r\n        let state = {};\r\n        /** @type {?} */\r\n        const ctx = this.context.createStateContext();\r\n        if (typeof this.ngAppModule.hmrNgxsStoreBeforeOnDestroy === 'function') {\r\n            state = this.ngAppModule.hmrNgxsStoreBeforeOnDestroy(ctx);\r\n        }\r\n        else {\r\n            state = ctx.getState();\r\n        }\r\n        ctx.dispatch(new HmrBeforeDestroyAction(state));\r\n        return state;\r\n    }\r\n    /**\r\n     * @private\r\n     * @param {?} callback\r\n     * @return {?}\r\n     */\r\n    stateEventLoop(callback) {\r\n        if (!this.storage.hasData())\r\n            return;\r\n        /** @type {?} */\r\n        const appBootstrapped$ = this.bootstrap.appBootstrapped$;\r\n        /** @type {?} */\r\n        const state$ = this.context.store.select((/**\r\n         * @param {?} state\r\n         * @return {?}\r\n         */\r\n        state => state));\r\n        appBootstrapped$.subscribe((/**\r\n         * @return {?}\r\n         */\r\n        () => {\r\n            /** @type {?} */\r\n            let eventId;\r\n            /** @type {?} */\r\n            const storeEventId = state$.subscribe((/**\r\n             * @return {?}\r\n             */\r\n            () => {\r\n                // setTimeout used for zone detection after set hmr state\r\n                clearInterval(eventId);\r\n                eventId = window.setTimeout((/**\r\n                 * @return {?}\r\n                 */\r\n                () => {\r\n                    // close check on the message queue\r\n                    storeEventId.unsubscribe();\r\n                    // if events are no longer running on the call stack,\r\n                    // then we can update the state\r\n                    callback(this.context.createStateContext(), (/** @type {?} */ (this.storage.snapshot)));\r\n                }), this.options.deferTime);\r\n            }));\r\n        }));\r\n    }\r\n}\r\nif (false) {\r\n    /**\r\n     * @type {?}\r\n     * @private\r\n     */\r\n    HmrLifecycle.prototype.ngAppModule;\r\n    /**\r\n     * @type {?}\r\n     * @private\r\n     */\r\n    HmrLifecycle.prototype.bootstrap;\r\n    /**\r\n     * @type {?}\r\n     * @private\r\n     */\r\n    HmrLifecycle.prototype.storage;\r\n    /**\r\n     * @type {?}\r\n     * @private\r\n     */\r\n    HmrLifecycle.prototype.context;\r\n    /**\r\n     * @type {?}\r\n     * @private\r\n     */\r\n    HmrLifecycle.prototype.options;\r\n}\n\n/**\r\n * @fileoverview added by tsickle\r\n * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc\r\n */\r\n/**\r\n * @template T, S\r\n */\r\nclass HmrManager {\r\n    /**\r\n     * @param {?} options\r\n     * @param {?} storage\r\n     */\r\n    constructor(options, storage) {\r\n        this.storage = storage;\r\n        this.optionsBuilder = new HmrOptionBuilder(options);\r\n    }\r\n    /**\r\n     * @private\r\n     * @return {?}\r\n     */\r\n    get applicationRef() {\r\n        return this.ngModule.injector.get(ApplicationRef);\r\n    }\r\n    /**\r\n     * @private\r\n     * @return {?}\r\n     */\r\n    get bootstrap() {\r\n        return this.ngModule.injector.get(NgxsBootstrapper);\r\n    }\r\n    /**\r\n     * @param {?} bootstrapFn\r\n     * @param {?} tick\r\n     * @return {?}\r\n     */\r\n    hmrModule(bootstrapFn, tick) {\r\n        return __awaiter(this, void 0, void 0, function* () {\r\n            InitialState.set(this.storage.snapshot);\r\n            this.ngModule = yield bootstrapFn();\r\n            this.context = new HmrStateContextFactory(this.ngModule);\r\n            this.lifecycle = this.createLifecycle();\r\n            tick();\r\n            InitialState.pop();\r\n            return this.ngModule;\r\n        });\r\n    }\r\n    /**\r\n     * @return {?}\r\n     */\r\n    beforeModuleBootstrap() {\r\n        this.lifecycle.hmrNgxsStoreOnInit((/**\r\n         * @param {?} ctx\r\n         * @param {?} state\r\n         * @return {?}\r\n         */\r\n        (ctx, state) => {\r\n            ctx.dispatch(new HmrInitAction(state));\r\n        }));\r\n    }\r\n    /**\r\n     * @return {?}\r\n     */\r\n    beforeModuleOnDestroy() {\r\n        this.optionsBuilder.clearLogs();\r\n        return this.lifecycle.hmrNgxsStoreBeforeOnDestroy();\r\n    }\r\n    /**\r\n     * @return {?}\r\n     */\r\n    createNewModule() {\r\n        /** @type {?} */\r\n        const removeOldHosts = this.cloneHostsBeforeDestroy();\r\n        this.removeNgStyles();\r\n        this.ngModule.destroy();\r\n        removeOldHosts();\r\n    }\r\n    /**\r\n     * @private\r\n     * @return {?}\r\n     */\r\n    createLifecycle() {\r\n        return new HmrLifecycle(this.ngModule.instance, this.bootstrap, this.storage, this.context, this.optionsBuilder);\r\n    }\r\n    /**\r\n     * @private\r\n     * @return {?}\r\n     */\r\n    cloneHostsBeforeDestroy() {\r\n        /** @type {?} */\r\n        const elements = this.applicationRef.components.map((/**\r\n         * @param {?} component\r\n         * @return {?}\r\n         */\r\n        (component) => component.location.nativeElement));\r\n        /** @type {?} */\r\n        const removableList = elements.map((/**\r\n         * @param {?} componentNode\r\n         * @return {?}\r\n         */\r\n        (componentNode) => {\r\n            /** @type {?} */\r\n            const newNode = document.createElement(componentNode.tagName);\r\n            /** @type {?} */\r\n            const parentNode = (/** @type {?} */ (componentNode.parentNode));\r\n            /** @type {?} */\r\n            const currentDisplay = newNode.style.display;\r\n            newNode.style.display = 'none';\r\n            parentNode.insertBefore(newNode, componentNode);\r\n            return (/**\r\n             * @return {?}\r\n             */\r\n            () => {\r\n                newNode.style.display = currentDisplay;\r\n                try {\r\n                    parentNode.removeChild(componentNode);\r\n                }\r\n                catch (_a) { }\r\n            });\r\n        }));\r\n        return (/**\r\n         * @return {?}\r\n         */\r\n        function removeOldHosts() {\r\n            removableList.forEach((/**\r\n             * @param {?} removeOldHost\r\n             * @return {?}\r\n             */\r\n            (removeOldHost) => removeOldHost()));\r\n        });\r\n    }\r\n    /**\r\n     * @private\r\n     * @return {?}\r\n     */\r\n    removeNgStyles() {\r\n        /** @type {?} */\r\n        const head = (/** @type {?} */ (document.head));\r\n        /** @type {?} */\r\n        const styles = Array.from((/** @type {?} */ (head)).querySelectorAll('style'));\r\n        styles\r\n            .filter((/**\r\n         * @param {?} style\r\n         * @return {?}\r\n         */\r\n        (style) => style.innerText.includes('_ng')))\r\n            .map((/**\r\n         * @param {?} style\r\n         * @return {?}\r\n         */\r\n        (style) => (/** @type {?} */ (head)).removeChild(style)));\r\n    }\r\n}\r\nif (false) {\r\n    /** @type {?} */\r\n    HmrManager.prototype.storage;\r\n    /** @type {?} */\r\n    HmrManager.prototype.context;\r\n    /** @type {?} */\r\n    HmrManager.prototype.lifecycle;\r\n    /** @type {?} */\r\n    HmrManager.prototype.optionsBuilder;\r\n    /**\r\n     * @type {?}\r\n     * @private\r\n     */\r\n    HmrManager.prototype.ngModule;\r\n}\n\n/**\r\n * @fileoverview added by tsickle\r\n * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc\r\n */\r\n/**\r\n * @template S\r\n */\r\nclass HmrStorage {\r\n    /**\r\n     * @param {?=} _snapshot\r\n     */\r\n    constructor(_snapshot = {}) {\r\n        this._snapshot = _snapshot;\r\n    }\r\n    /**\r\n     * @return {?}\r\n     */\r\n    hasData() {\r\n        return Object.keys(this._snapshot).length > 0;\r\n    }\r\n    /**\r\n     * @return {?}\r\n     */\r\n    get snapshot() {\r\n        return this._snapshot;\r\n    }\r\n}\r\nif (false) {\r\n    /**\r\n     * @type {?}\r\n     * @private\r\n     */\r\n    HmrStorage.prototype._snapshot;\r\n}\n\n/**\r\n * @fileoverview added by tsickle\r\n * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc\r\n */\r\n/**\r\n * @param {?} value\r\n * @return {?}\r\n */\r\nfunction setHmrReloadedTo(value) {\r\n    if (window[\"NGXS_HMR_LIFECYCLE_STATUS\" /* Status */]) {\r\n        window[\"NGXS_HMR_LIFECYCLE_STATUS\" /* Status */].hmrReloaded = value;\r\n    }\r\n}\r\n/**\r\n * @return {?}\r\n */\r\nfunction markApplicationAsHmrReloaded() {\r\n    window[\"NGXS_HMR_LIFECYCLE_STATUS\" /* Status */] = window[\"NGXS_HMR_LIFECYCLE_STATUS\" /* Status */] || {\r\n        hmrReloaded: false\r\n    };\r\n}\n\n/**\r\n * @fileoverview added by tsickle\r\n * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc\r\n */\r\n/**\r\n * @template T\r\n * @param {?} webpackModule\r\n * @param {?} bootstrapFn\r\n * @param {?=} options\r\n * @return {?}\r\n */\r\nfunction hmr(webpackModule, bootstrapFn, options = {}) {\r\n    return __awaiter(this, void 0, void 0, function* () {\r\n        if (!webpackModule.hot) {\r\n            console.error('Are you using the --hmr flag for ng serve?');\r\n            throw new Error('HMR is not enabled for webpack-dev-server!');\r\n        }\r\n        markApplicationAsHmrReloaded();\r\n        webpackModule.hot.accept();\r\n        /**\r\n         * @record\r\n         */\r\n        function HmrDataTransfer() { }\r\n        if (false) {\r\n            /** @type {?|undefined} */\r\n            HmrDataTransfer.prototype.snapshot;\r\n        }\r\n        /** @type {?} */\r\n        const dataTransfer = webpackModule.hot.data || {};\r\n        /** @type {?} */\r\n        const storage = new HmrStorage(dataTransfer.snapshot || {});\r\n        /** @type {?} */\r\n        const manager = new HmrManager(options, storage);\r\n        return yield manager.hmrModule(bootstrapFn, (/**\r\n         * @return {?}\r\n         */\r\n        () => {\r\n            manager.beforeModuleBootstrap();\r\n            (/** @type {?} */ (webpackModule.hot)).dispose((/**\r\n             * @param {?} data\r\n             * @return {?}\r\n             */\r\n            (data) => {\r\n                setHmrReloadedTo(true);\r\n                data.snapshot = manager.beforeModuleOnDestroy();\r\n                manager.createNewModule();\r\n            }));\r\n        }));\r\n    });\r\n}\n\n/**\r\n * @fileoverview added by tsickle\r\n * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc\r\n */\r\n/**\r\n * @return {?}\r\n */\r\nfunction hmrIsReloaded() {\r\n    return !!(window[\"NGXS_HMR_LIFECYCLE_STATUS\" /* Status */] && window[\"NGXS_HMR_LIFECYCLE_STATUS\" /* Status */].hmrReloaded);\r\n}\n\n/**\r\n * @fileoverview added by tsickle\r\n * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc\r\n */\n\n/**\r\n * @fileoverview added by tsickle\r\n * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc\r\n */\n\n/**\r\n * @fileoverview added by tsickle\r\n * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc\r\n */\n\nexport { HmrBeforeDestroyAction, HmrInitAction, hmr, hmrIsReloaded };\n\n//# sourceMappingURL=ngxs-hmr-plugin.js.map"]}