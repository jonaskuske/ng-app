function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function _createClass(e,t,n){return t&&_defineProperties(e.prototype,t),n&&_defineProperties(e,n),e}(window.webpackJsonp=window.webpackJsonp||[]).push([[3],{"lCZ+":function(e,t,n){"use strict";n.r(t),n.d(t,"HmrBeforeDestroyAction",(function(){return c})),n.d(t,"HmrInitAction",(function(){return u})),n.d(t,"hmr",(function(){return g})),n.d(t,"hmrIsReloaded",(function(){return y}));var r=n("mrSG"),o=n("fXoL"),s=n("z5Zb"),i=n("AcyG"),a=n("tkUl"),u=function(){function e(t){_classCallCheck(this,e),this.payload=t}return _createClass(e,null,[{key:"type",get:function(){return"@@HMR_INIT"}}]),e}(),c=function(){function e(t){_classCallCheck(this,e),this.payload=t}return _createClass(e,null,[{key:"type",get:function(){return"@@HMR_BEFORE_DESTROY"}}]),e}(),l=function(){function e(t){_classCallCheck(this,e);var n=t.injector.get(i.k,void 0);if(!n)throw new Error("Store not found, maybe you forgot to import the NgxsModule");this.store=n}return _createClass(e,[{key:"createStateContext",value:function(){var e=this;return{dispatch:function(t){return e.store.dispatch(t)},getState:function(){return e.store.snapshot()},setState:function(t){return Object(a.a)(t)&&(t=t(e.store.snapshot())),e.store.reset(t),t},patchState:function(t){var n=e.store.snapshot(),r=Object.assign({},n,t);return e.store.reset(r),r}}}}]),e}(),h=function(){function e(t){var n=t.deferTime,r=t.autoClearLogs;_classCallCheck(this,e),this.deferTime=n||100,this.autoClearLogs=void 0===r||r}return _createClass(e,[{key:"clearLogs",value:function(){this.autoClearLogs&&console.clear()}}]),e}(),f=function(){function e(t,n,r,o,s){_classCallCheck(this,e),this.ngAppModule=t,this.bootstrap=n,this.storage=r,this.context=o,this.options=s}return _createClass(e,[{key:"hmrNgxsStoreOnInit",value:function(e){var t=this.getModuleHmrInitCallback();t=t.bind(this.ngAppModule),this.stateEventLoop((function(n,r){t(n,r),e(n,r)}))}},{key:"getModuleHmrInitCallback",value:function(){return"function"==typeof this.ngAppModule.hmrNgxsStoreOnInit?this.ngAppModule.hmrNgxsStoreOnInit:function(e,t){e.patchState(t)}}},{key:"hmrNgxsStoreBeforeOnDestroy",value:function(){var e,t=this.context.createStateContext();return e="function"==typeof this.ngAppModule.hmrNgxsStoreBeforeOnDestroy?this.ngAppModule.hmrNgxsStoreBeforeOnDestroy(t):t.getState(),t.dispatch(new c(e)),e}},{key:"stateEventLoop",value:function(e){var t=this;if(this.storage.hasData()){var n=this.bootstrap.appBootstrapped$,r=this.context.store.select((function(e){return e}));n.subscribe((function(){var n,o=r.subscribe((function(){clearInterval(n),n=window.setTimeout((function(){o.unsubscribe(),e(t.context.createStateContext(),t.storage.snapshot)}),t.options.deferTime)}))}))}}}]),e}(),p=function(){function e(t,n){_classCallCheck(this,e),this.storage=n,this.optionsBuilder=new h(t)}return _createClass(e,[{key:"hmrModule",value:function(e,t){return Object(r.a)(this,void 0,void 0,regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return s.b.set(this.storage.snapshot),n.next=3,e();case 3:return this.ngModule=n.sent,this.context=new l(this.ngModule),this.lifecycle=this.createLifecycle(),t(),s.b.pop(),n.abrupt("return",this.ngModule);case 9:case"end":return n.stop()}}),n,this)})))}},{key:"beforeModuleBootstrap",value:function(){this.lifecycle.hmrNgxsStoreOnInit((function(e,t){e.dispatch(new u(t))}))}},{key:"beforeModuleOnDestroy",value:function(){return this.optionsBuilder.clearLogs(),this.lifecycle.hmrNgxsStoreBeforeOnDestroy()}},{key:"createNewModule",value:function(){var e=this.cloneHostsBeforeDestroy();this.removeNgStyles(),this.ngModule.destroy(),e()}},{key:"createLifecycle",value:function(){return new f(this.ngModule.instance,this.bootstrap,this.storage,this.context,this.optionsBuilder)}},{key:"cloneHostsBeforeDestroy",value:function(){var e=this.applicationRef.components.map((function(e){return e.location.nativeElement})).map((function(e){var t=document.createElement(e.tagName),n=e.parentNode,r=t.style.display;return t.style.display="none",n.insertBefore(t,e),function(){t.style.display=r;try{n.removeChild(e)}catch(o){}}}));return function(){e.forEach((function(e){return e()}))}}},{key:"removeNgStyles",value:function(){var e=document.head;Array.from(e.querySelectorAll("style")).filter((function(e){return e.innerText.includes("_ng")})).map((function(t){return e.removeChild(t)}))}},{key:"applicationRef",get:function(){return this.ngModule.injector.get(o.g)}},{key:"bootstrap",get:function(){return this.ngModule.injector.get(s.e)}}]),e}(),d=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};_classCallCheck(this,e),this._snapshot=t}return _createClass(e,[{key:"hasData",value:function(){return Object.keys(this._snapshot).length>0}},{key:"snapshot",get:function(){return this._snapshot}}]),e}();function g(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return Object(r.a)(this,void 0,void 0,regeneratorRuntime.mark((function r(){var o,s;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(e.hot){r.next=2;break}throw console.error("Are you using the --hmr flag for ng serve?"),new Error("HMR is not enabled for webpack-dev-server!");case 2:return window.NGXS_HMR_LIFECYCLE_STATUS=window.NGXS_HMR_LIFECYCLE_STATUS||{hmrReloaded:!1},e.hot.accept(),o=new d((e.hot.data||{}).snapshot||{}),s=new p(n,o),r.next=6,s.hmrModule(t,(function(){s.beforeModuleBootstrap(),e.hot.dispose((function(e){window.NGXS_HMR_LIFECYCLE_STATUS&&(window.NGXS_HMR_LIFECYCLE_STATUS.hmrReloaded=!0),e.snapshot=s.beforeModuleOnDestroy(),s.createNewModule()}))}));case 6:return r.abrupt("return",r.sent);case 7:case"end":return r.stop()}}),r)})))}function y(){return!(!window.NGXS_HMR_LIFECYCLE_STATUS||!window.NGXS_HMR_LIFECYCLE_STATUS.hmrReloaded)}}}]);
//# sourceMappingURL=ngxs-hmr-plugin-es5.93e98974faf45ef720f3.js.map